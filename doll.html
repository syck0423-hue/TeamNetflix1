<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì›€ì§ì´ëŠ” ì¸í˜• ëˆˆ</title>
<style>
  body {
    background: black;
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 574px;
  }

  .stage {
    position: relative;
    width: 926px;
    height: 574px;
    background: #111;
    overflow: hidden;
  }

  .doll {
    position: absolute;
    width: 216px;
    height: 503px;
    user-select: none;
    cursor: grab;
  }

  .doll:active {
    cursor: grabbing;
  }

  .body {
    width: 100%;
    height: auto;
    display: block;
    position: relative;
    z-index: 1;
    pointer-events: none; /* ë“œë˜ê·¸ ì‹œ ì´ë¯¸ì§€ ì¡íˆëŠ” í˜„ìƒ ë°©ì§€ */
  }

  .eyes {
    position: absolute;
    top: 78px;
    left: 37px;
    width: 112px;
    height: 60px;
    background: url("img/doll/eye.png") no-repeat center;
    background-size: contain;
    pointer-events: none;
    transition: transform 0.05s linear;
    z-index: 0;
  }
</style>
</head>
<body>

<div class="stage" id="stage">
  <!-- ì™¼ìª½ ì¸í˜• (ë“œë˜ê·¸ + ëˆˆ ì›€ì§ì„) -->
  <div class="doll" id="doll-left" style="left: 150px; top: 50px;">
    <img src="img/doll/body.png" class="body" alt="ì¸í˜• ëª¸">
    <div class="eyes" id="eyes-left"></div>
  </div>

  <!-- ì˜¤ë¥¸ìª½ ì¸í˜• (ê³ ì •) -->
  <div class="doll" id="doll-right" style="right: 150px; bottom: 50px;">
    <img src="img/doll/body.png" class="body" alt="ì¸í˜• ëª¸">
    <div class="eyes" id="eyes-right"></div>
  </div>
</div>

<script>
  const eyesLeft = document.getElementById("eyes-left");
  const dollLeft = document.getElementById("doll-left");
  const stage = document.getElementById("stage");

  // ğŸ‘ ëˆˆ ì›€ì§ì„
  document.addEventListener("mousemove", (e) => {
    const rect = dollLeft.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 3.5;

    const dx = e.clientX - centerX;
    const dy = e.clientY - centerY;
    const angle = Math.atan2(dy, dx);

    const moveRadius = 6;
    const offsetX = Math.cos(angle) * moveRadius;
    const offsetY = Math.sin(angle) * moveRadius;

    eyesLeft.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
  });

  // ğŸ§¸ ë“œë˜ê·¸ ê¸°ëŠ¥
  let isDragging = false;
  let offsetX = 0;
  let offsetY = 0;

  dollLeft.addEventListener("mousedown", (e) => {
    e.preventDefault(); // ê¸°ë³¸ ë“œë˜ê·¸ ë°©ì§€
    isDragging = true;

    const rect = dollLeft.getBoundingClientRect();
    const stageRect = stage.getBoundingClientRect();

    offsetX = e.clientX - rect.left;
    offsetY = e.clientY - rect.top;

    // í´ë¦­ ì‹œ ë§¨ ìœ„ë¡œ ì˜¬ë¦¬ê¸°
    dollLeft.style.zIndex = 9999;
    dollLeft.style.cursor = "grabbing";
  });

  document.addEventListener("mousemove", (e) => {
    if (!isDragging) return;

    const stageRect = stage.getBoundingClientRect();

    let x = e.clientX - stageRect.left - offsetX;
    let y = e.clientY - stageRect.top - offsetY;

    const maxX = stageRect.width - dollLeft.offsetWidth;
    const maxY = stageRect.height - dollLeft.offsetHeight;

    // ë²”ìœ„ ì œí•œ
    x = Math.max(0, Math.min(x, maxX));
    y = Math.max(0, Math.min(y, maxY));

    dollLeft.style.left = `${x}px`;
    dollLeft.style.top = `${y}px`;
  });

  document.addEventListener("mouseup", () => {
    if (!isDragging) return;
    isDragging = false;

    dollLeft.style.cursor = "grab";
    // ë“œë˜ê·¸ ëë‚˜ë„ z-index ìœ ì§€ (ìì—°ìŠ¤ëŸ¬ì›€ ìœ ì§€)
  });

  // ğŸ§© ê¸°ë³¸ ì´ë¯¸ì§€ ë“œë˜ê·¸ ë°©ì§€ (ê¸ˆì§€í‘œì‹œ ì œê±° í•µì‹¬)
  document.querySelectorAll("img").forEach(img => {
    img.addEventListener("dragstart", (e) => e.preventDefault());
  });
</script>

</body>
</html>
