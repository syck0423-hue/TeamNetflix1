<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>원 내부 음식 랜덤 배치 (겹침 방지 + 경계 유지)</title>
<style>
  body {
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  .stage {
    position: relative;
    width: 926px;
    height: 574px;
    background: url('img/food/bg.png') no-repeat center center;
    background-size: contain;
  }

  .circle {
    position: absolute;
    width: 342px;
    height: 342px;
    border-radius: 50%;
    background: rgba(255, 150, 150, 0.2);
    top: 126px;
    left: 83px;
    overflow: hidden;
  }

  .box {
    position: absolute;
    width: 333px;
    height: 431px;
    background: rgba(150, 150, 255, 0.2);
    top: 71px;
    right: 76px;
  }

  .food {
    position: absolute;
    user-select: none;
    pointer-events: none;
  }
</style>
</head>
<body>

<div class="stage">
  <div class="circle" id="circle"></div>
  <div class="box"></div>
</div>

<script>
  const circle = document.getElementById("circle");

  const foods = [
    { name: "BREATHE", size: [135, 47] },
    { name: "CORRECT", size: [121, 45] },
    { name: "DIG", size: [55, 48] },
    { name: "ELECTRIC", size: [130, 43] },
    { name: "GLASS", size: [106, 32] },
    { name: "KID", size: [58, 44] },
    { name: "NETFLIX", size: [137, 36] },
    { name: "SUSTAIN", size: [121, 43] },
    { name: "TRICK", size: [88, 36] },
    { name: "XERASIA", size: [143, 46] }
  ];

  const circleRadius = 342 / 2;
  const placed = []; // 배치된 이미지 정보 저장
  const buffer = 8; // 이미지 간 최소 간격

  function isOverlapping(x, y, w, h) {
    for (const p of placed) {
      if (
        x < p.x + p.w + buffer &&
        x + w > p.x - buffer &&
        y < p.y + p.h + buffer &&
        y + h > p.y - buffer
      ) {
        return true;
      }
    }
    return false;
  }

  foods.forEach(food => {
    const img = document.createElement("img");
    img.src = `img/food/${food.name}.png`;
    img.className = "food";

    const [w, h] = food.size;
    img.style.width = `${w}px`;
    img.style.height = `${h}px`;

    let x, y, tries = 0;
    const maxTries = 1000;

    // 원 내부 & 겹침 없는 좌표 찾기
    do {
      const angle = Math.random() * 2 * Math.PI;
      const radius = Math.random() * (circleRadius - Math.max(w, h) / 2);
      const centerX = circleRadius + Math.cos(angle) * radius;
      const centerY = circleRadius + Math.sin(angle) * radius;

      x = centerX - w / 2;
      y = centerY - h / 2;

      tries++;
      if (tries > maxTries) break;

      // 원 경계 체크
      const corners = [
        [x, y],
        [x + w, y],
        [x, y + h],
        [x + w, y + h]
      ];

      const insideCircle = corners.every(([cx, cy]) => {
        const dx = cx - circleRadius;
        const dy = cy - circleRadius;
        return Math.sqrt(dx * dx + dy * dy) <= circleRadius;
      });

      if (!insideCircle) continue;
      if (isOverlapping(x, y, w, h)) continue;

      // 조건 만족 시 배치 확정
      img.style.left = `${x}px`;
      img.style.top = `${y}px`;
      placed.push({ x, y, w, h });
      circle.appendChild(img);
      break;
    } while (true);
  });
</script>

</body>
</html>
