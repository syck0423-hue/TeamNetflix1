<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>íŒë‹¤ í´ë¦­ ë¦¬ë“¬ê²Œì„</title>
<style>
  @font-face {
    font-family: 'Juache';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_one@1.0/BMJUA.woff') format('woff');
    font-weight: normal;
    font-display: swap;
}
  body {
    margin: 0;
    background: #222;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  .stage {
    position: relative;
    width: 926px;
    height: 574px;
    background: url("img/panda/bg.png") no-repeat center/cover;
    overflow: hidden;
  }

  .item { position: absolute; }

  .item1 { left: 343px; bottom: 152px; width: 259px; height: 343px; }
  .item2 { left: 96px; top: 45px; width: 239px; height: 307px; }
  .item3 { left: 57px; top: 433px; width: 237px; height: 304px; transition: transform 0.6s ease; cursor: pointer; }
  .item4 { right: 57px; top: 433px; width: 239px; height: 307px; transition: transform 0.6s ease; cursor: pointer; }
  .item5 { right: 74px; top: 74px; width: 236px; height: 87px; }

  .item3:hover, .item4:hover { transform: translateY(-30px); }
  .item3.clicked, .item4.clicked { transform: translateY(-160px); }

  .note {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 126px;
    height: 268px;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 10;
  }

  #noteL { left: 5px; }
  #noteR { right: 5px; }
  .show { opacity: 1; }
  
  /* === ë‹¤ì´ì–¼ & ENTER UI === */
.dial {
  position: absolute;       /* ìœ„ì¹˜ ììœ  */
  display: flex;
  align-items: center;
  gap: 3px;
  font-family: 'Juache', sans-serif;
  font-size: 30px;
  color: #cccccc;
  user-select: none;
  cursor: default;
}

.dial .arrow {
  cursor: pointer;
  font-size : 10px;
}

.dial .value {
  min-width: 22px;
  text-align: center;
  font-weight: bold;
  letter-spacing: 2px;
}

/* ENTER ë²„íŠ¼ */
.enter-btn {
  position: absolute;  /* ììœ  ìœ„ì¹˜ */
  font-family: 'Juache', sans-serif;
  font-size: 28px;
  font-weight: bold;
  color: #cccccc;
  cursor: pointer;
  user-select: none;
}

/* ğŸ¯ ìœ„ì¹˜ ì˜ˆì‹œ â€” ììœ ë¡­ê²Œ ë°”ê¾¸ë©´ ë¨ */
#dial1 { right: 254px; top: 100px; }
#dial2 { right: 198px; top: 100px; }
#dial3 { right: 138px; top: 100px; }
#dial4 { right: 80px; top: 100px; }
#enterBtn { right: 150px; top: 153px; }

.dial, .enter-btn {
  opacity: 0;
  transition: opacity 0.8s ease;
}

/* ë‚˜íƒ€ë‚  ë•Œ */
.show-ui {
  opacity: 1;
}

</style>
</head>
<body>
  <div class="stage">
    <div class="item item1"><img id="pandaImg" src="img/panda/basic.gif"></div>
    <div class="item item2"><img id="textImg" src="img/panda/text.gif"></div>
    <div class="item item3" id="leftBtn"><img src="img/panda/left.gif"></div>
    <div class="item item4" id="rightBtn"><img src="img/panda/right.gif"></div>
    <div class="item item5"><img id="clearImg" src="img/panda/c_0.png"></div>

    <img id="noteL" class="note" src="img/panda/soundL.gif" alt="ì™¼ìª½ ìŒí‘œ">
    <img id="noteR" class="note" src="img/panda/soundR.gif" alt="ì˜¤ë¥¸ìª½ ìŒí‘œ">

    <div class="dial" id="dial1" data-index="0">
  <span class="arrow" data-dir="-1">â—€</span>
  <span class="value">A</span>
  <span class="arrow" data-dir="1">â–¶</span>
</div>
<div class="dial" id="dial2" data-index="1">
  <span class="arrow" data-dir="-1">â—€</span>
  <span class="value">A</span>
  <span class="arrow" data-dir="1">â–¶</span>
</div>
<div class="dial" id="dial3" data-index="2">
  <span class="arrow" data-dir="-1">â—€</span>
  <span class="value">A</span>
  <span class="arrow" data-dir="1">â–¶</span>
</div>
<div class="dial" id="dial4" data-index="3">
  <span class="arrow" data-dir="-1">â—€</span>
  <span class="value">A</span>
  <span class="arrow" data-dir="1">â–¶</span>
</div>

<div class="enter-btn" id="enterBtn">ENTER</div>
  </div>

  <script>
    const sequence = ["left", "left", "right", "left"];
    let currentRound = 0;
    const totalRounds = sequence.length;
    let gameEnded = false;
    let canClick = false;

    const noteL = document.getElementById("noteL");
    const noteR = document.getElementById("noteR");
    const clearImg = document.getElementById("clearImg");
    const pandaImg = document.getElementById("pandaImg");
    const textImg = document.getElementById("textImg");
    const leftBtn = document.getElementById("leftBtn");
    const rightBtn = document.getElementById("rightBtn");

    // ğŸµ ìŒí‘œ í‘œì‹œ
    function showNote() {
      if (gameEnded) return;
      canClick = false; // âœ… í´ë¦­ ì ê¸ˆ ìƒíƒœë¡œ ì‹œì‘

      pandaImg.src = "img/panda/basic.gif";

      leftBtn.classList.remove("clicked");
      rightBtn.classList.remove("clicked");

      noteL.classList.remove("show");
      noteR.classList.remove("show");

      // 1ì´ˆ í›„ ìŒí‘œ í‘œì‹œ
      setTimeout(() => {
        const current = sequence[currentRound];
        if (current === "left") noteL.classList.add("show");
        else if (current === "right") noteR.classList.add("show");

        // âœ… ìŒí‘œê°€ ì‹¤ì œë¡œ ë‚˜íƒ€ë‚œ ì§í›„ í´ë¦­ í—ˆìš©
        setTimeout(() => { canClick = true; }, 300);
      }, 1000);
    }

    // ğŸ® í´ë¦­ ì²˜ë¦¬
    leftBtn.addEventListener("click", () => handlePress("left", leftBtn));
    rightBtn.addEventListener("click", () => handlePress("right", rightBtn));

    function handlePress(dir, btn) {
      // ğŸ”’ ìŒí‘œê°€ ëœ¨ì§€ ì•Šì•˜ê±°ë‚˜ ê²Œì„ ì¢…ë£Œ ìƒíƒœë©´ ë°˜ì‘ ì•ˆ í•¨
      if (gameEnded || !canClick) return;

      canClick = false;

      noteL.classList.remove("show");
      noteR.classList.remove("show");

      btn.classList.add("clicked");

      setTimeout(() => btn.classList.remove("clicked"), 2000);

      handleInput(dir);
    }

    // âœ… ì…ë ¥ íŒì •
    function handleInput(dir) {
      if (dir === sequence[currentRound]) {
        showGood();
        currentRound++;
        clearImg.src = `img/panda/c_${currentRound}.png`;

        if (currentRound < totalRounds) {
          setTimeout(showNote, 2000);
        } else {
          showFinalClear();
        }
      } else {
        showBad();
        currentRound = 0;
        clearImg.src = "img/panda/c_0.png";
        textImg.src = "img/panda/text.gif";

        setTimeout(() => {
          pandaImg.src = "img/panda/basic.gif";
          showNote();
        }, 2000);
      }
    }

    function showGood() { pandaImg.src = "img/panda/good.gif"; }
    function showBad() { pandaImg.src = "img/panda/bad.gif"; }

    // ğŸ‰ ìµœì¢… í´ë¦¬ì–´
function showFinalClear() {
  gameEnded = true;
  clearImg.src = "img/panda/c_4.png";
  pandaImg.src = "img/panda/good.gif";

  // 1ï¸âƒ£ ì† ë‚´ë ¤ê°€ë©´ì„œ íŒë‹¤ ë°”ë¡œ basicìœ¼ë¡œ ë³µê·€
  setTimeout(() => {
    leftBtn.classList.remove("clicked");
    rightBtn.classList.remove("clicked");
    pandaImg.src = "img/panda/basic.gif"; // âœ… ë™ì‹œì— ë³€ê²½
  }, 2000);

  // 2ï¸âƒ£ 0.8ì´ˆ ë’¤ middle.gifë¡œ ë³€ê²½ + c_0.pngë¡œ ë³µê·€ (ìœ„ì¹˜ ì¡°ì •)
  setTimeout(() => {
    textImg.src = "img/panda/middle.gif";
    clearImg.src = "img/panda/c_0.png";
    clearImg.style.transform = "translateY(-20px)";
    
    // âœ… ê²Œì„ ì¢…ë£Œ í›„ ë‹¤ì´ì–¼ê³¼ ENTER í‘œì‹œ
    document.querySelectorAll(".dial, .enter-btn").forEach(el => {
      el.classList.add("show-ui");
    });
  }, 2800);
}

    // ğŸš€ í˜ì´ì§€ ë¡œë“œ í›„ 0.8ì´ˆ ë’¤ ì²« ìŒí‘œ í‘œì‹œ
    window.addEventListener("load", () => {
      setTimeout(showNote, 800);
    });
    const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
let dialStates = [0, 0, 0, 0];

document.querySelectorAll(".dial").forEach((dial, index) => {
  dial.addEventListener("click", (e) => {
    if (!e.target.classList.contains("arrow")) return;
    const dir = parseInt(e.target.dataset.dir, 10);
    dialStates[index] = (dialStates[index] + dir + letters.length) % letters.length;
    dial.querySelector(".value").textContent = letters[dialStates[index]];
  });
});

document.getElementById("enterBtn").addEventListener("click", () => {
  const code = dialStates.map(i => letters[i]).join("");
  console.log("ì…ë ¥ëœ ì½”ë“œ:", code);
  // âœ… ì—¬ê¸°ì— ENTER ëˆŒë €ì„ ë•Œ ë™ì‘ ì¶”ê°€ ê°€ëŠ¥ (ì •ë‹µì²´í¬, ì—°ì¶œ ë“±)
});
  </script>
</body>
</html>
